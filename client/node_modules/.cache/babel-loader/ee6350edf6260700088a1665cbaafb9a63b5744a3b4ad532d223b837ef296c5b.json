{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shesecure\\\\client\\\\src\\\\components\\\\MapView.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\n\n// Loaders\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst loadLeafletCSS = () => {\n  if (!document.getElementById('leaflet-css')) {\n    const link = document.createElement('link');\n    link.id = 'leaflet-css';\n    link.rel = 'stylesheet';\n    link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n    document.head.appendChild(link);\n  }\n};\nconst loadLeafletScript = cb => {\n  if (window.L) {\n    cb();\n    return;\n  }\n  const script = document.createElement('script');\n  script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\n  script.onload = () => cb();\n  document.head.appendChild(script);\n};\nconst MapView = ({\n  userPosition,\n  destination,\n  isTripActive\n}) => {\n  _s();\n  const mapContainerRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n  const userMarkerRef = useRef(null);\n  const destMarkerRef = useRef(null);\n  const polylineRef = useRef(null);\n  const [isMapReady, setIsMapReady] = useState(false);\n  useEffect(() => {\n    loadLeafletCSS();\n    loadLeafletScript(() => setIsMapReady(true));\n  }, []);\n\n  // Update map when userPosition changes (passed from Dashboard)\n  useEffect(() => {\n    if (isMapReady && mapContainerRef.current && window.L) {\n      const L = window.L;\n\n      // 1. Init Map\n      if (!mapInstanceRef.current) {\n        mapInstanceRef.current = L.map(mapContainerRef.current).setView([userPosition.lat, userPosition.lng], 13);\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mapInstanceRef.current);\n      }\n\n      // 2. Update User Marker\n      if (!userMarkerRef.current) {\n        // Custom icon to prevent 404s\n        const icon = new L.Icon({\n          iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n          shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n          iconSize: [25, 41],\n          iconAnchor: [12, 41]\n        });\n        userMarkerRef.current = L.marker([userPosition.lat, userPosition.lng], {\n          icon\n        }).addTo(mapInstanceRef.current);\n      } else {\n        userMarkerRef.current.setLatLng([userPosition.lat, userPosition.lng]);\n        if (isTripActive) mapInstanceRef.current.panTo([userPosition.lat, userPosition.lng]);\n      }\n\n      // 3. Update Destination\n      if (destination) {\n        if (!destMarkerRef.current) {\n          destMarkerRef.current = L.marker([destination.lat, destination.lon]).addTo(mapInstanceRef.current);\n        } else {\n          destMarkerRef.current.setLatLng([destination.lat, destination.lon]);\n        }\n\n        // Draw Line\n        const path = [[userPosition.lat, userPosition.lng], [destination.lat, destination.lon]];\n        if (!polylineRef.current) polylineRef.current = L.polyline(path, {\n          color: 'blue'\n        }).addTo(mapInstanceRef.current);else polylineRef.current.setLatLngs(path);\n\n        // Only fit bounds if we aren't actively tracking (to avoid fighting the panTo)\n        if (!isTripActive) mapInstanceRef.current.fitBounds(path, {\n          padding: [50, 50]\n        });\n      } else {\n        if (destMarkerRef.current) {\n          destMarkerRef.current.remove();\n          destMarkerRef.current = null;\n        }\n        if (polylineRef.current) {\n          polylineRef.current.remove();\n          polylineRef.current = null;\n        }\n      }\n    }\n  }, [isMapReady, userPosition, destination, isTripActive]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: mapContainerRef,\n    style: {\n      width: '100%',\n      height: '100%'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 10\n  }, this);\n};\n_s(MapView, \"H6mCQ1wvrVGU9Av9PgAJBctMntU=\");\n_c = MapView;\nexport default MapView;\nvar _c;\n$RefreshReg$(_c, \"MapView\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","loadLeafletCSS","document","getElementById","link","createElement","id","rel","href","head","appendChild","loadLeafletScript","cb","window","L","script","src","onload","MapView","userPosition","destination","isTripActive","_s","mapContainerRef","mapInstanceRef","userMarkerRef","destMarkerRef","polylineRef","isMapReady","setIsMapReady","current","map","setView","lat","lng","tileLayer","addTo","icon","Icon","iconUrl","shadowUrl","iconSize","iconAnchor","marker","setLatLng","panTo","lon","path","polyline","color","setLatLngs","fitBounds","padding","remove","ref","style","width","height","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/LENOVO/Desktop/shesecure/client/src/components/MapView.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\n\r\n// Loaders\r\nconst loadLeafletCSS = () => {\r\n  if (!document.getElementById('leaflet-css')) {\r\n    const link = document.createElement('link'); link.id = 'leaflet-css'; link.rel = 'stylesheet'; link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'; document.head.appendChild(link);\r\n  }\r\n};\r\nconst loadLeafletScript = (cb) => {\r\n  if (window.L) { cb(); return; }\r\n  const script = document.createElement('script'); script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js'; script.onload = () => cb(); document.head.appendChild(script);\r\n};\r\n\r\nconst MapView = ({ userPosition, destination, isTripActive }) => {\r\n  const mapContainerRef = useRef(null);\r\n  const mapInstanceRef = useRef(null);\r\n  const userMarkerRef = useRef(null);\r\n  const destMarkerRef = useRef(null);\r\n  const polylineRef = useRef(null);\r\n  const [isMapReady, setIsMapReady] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadLeafletCSS();\r\n    loadLeafletScript(() => setIsMapReady(true));\r\n  }, []);\r\n\r\n  // Update map when userPosition changes (passed from Dashboard)\r\n  useEffect(() => {\r\n    if (isMapReady && mapContainerRef.current && window.L) {\r\n      const L = window.L;\r\n\r\n      // 1. Init Map\r\n      if (!mapInstanceRef.current) {\r\n        mapInstanceRef.current = L.map(mapContainerRef.current).setView([userPosition.lat, userPosition.lng], 13);\r\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mapInstanceRef.current);\r\n      }\r\n\r\n      // 2. Update User Marker\r\n      if (!userMarkerRef.current) {\r\n        // Custom icon to prevent 404s\r\n        const icon = new L.Icon({ \r\n            iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\r\n            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\r\n            iconSize: [25, 41], iconAnchor: [12, 41]\r\n        });\r\n        userMarkerRef.current = L.marker([userPosition.lat, userPosition.lng], {icon}).addTo(mapInstanceRef.current);\r\n      } else {\r\n        userMarkerRef.current.setLatLng([userPosition.lat, userPosition.lng]);\r\n        if(isTripActive) mapInstanceRef.current.panTo([userPosition.lat, userPosition.lng]);\r\n      }\r\n\r\n      // 3. Update Destination\r\n      if (destination) {\r\n        if (!destMarkerRef.current) {\r\n             destMarkerRef.current = L.marker([destination.lat, destination.lon]).addTo(mapInstanceRef.current);\r\n        } else {\r\n             destMarkerRef.current.setLatLng([destination.lat, destination.lon]);\r\n        }\r\n        \r\n        // Draw Line\r\n        const path = [[userPosition.lat, userPosition.lng], [destination.lat, destination.lon]];\r\n        if (!polylineRef.current) polylineRef.current = L.polyline(path, { color: 'blue' }).addTo(mapInstanceRef.current);\r\n        else polylineRef.current.setLatLngs(path);\r\n        \r\n        // Only fit bounds if we aren't actively tracking (to avoid fighting the panTo)\r\n        if (!isTripActive) mapInstanceRef.current.fitBounds(path, { padding: [50, 50] });\r\n      } else {\r\n        if (destMarkerRef.current) { destMarkerRef.current.remove(); destMarkerRef.current = null; }\r\n        if (polylineRef.current) { polylineRef.current.remove(); polylineRef.current = null; }\r\n      }\r\n    }\r\n  }, [isMapReady, userPosition, destination, isTripActive]);\r\n\r\n  return <div ref={mapContainerRef} style={{ width: '100%', height: '100%' }} />;\r\n};\r\n\r\nexport default MapView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}