{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\LENOVO\\\\Desktop\\\\shesecure\\\\client\\\\src\\\\Pages\\\\Dashboard.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\n// ... (Imports & Styles remain the same, just copy them from previous response if needed) ...\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { io } from 'socket.io-client';\n\n// ... (KEEP YOUR EXISTING STYLES AND LOADERS HERE) ...\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DashboardStyles = () => /*#__PURE__*/_jsxDEV(\"style\", {\n  children: `\n    .dashboard-layout { display: flex; height: calc(100vh - 70px); background-color: #f3f4f6; }\n    .map-column { flex: 3; background-color: #e5e7eb; position: relative; }\n    .controls-column { flex: 2; background-color: #ffffff; padding: 1.5rem; overflow-y: auto; }\n    .panel-container { height: 100%; display: flex; flex-direction: column; }\n    /* ... (rest of styles) ... */\n    .timer-display { text-align: center; margin: 2rem 0; }\n    .timer-display span { font-size: 3.5rem; font-weight: bold; color: #111; }\n    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; display: flex; justify-content: center; align-items: center; }\n    .modal-content { background: white; padding: 20px; width: 350px; border-radius: 8px; }\n    .share-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }\n  `\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 9,\n  columnNumber: 3\n}, this);\n// ... (KEEP MAPVIEW AND BEFORETRIPPANEL HERE) ...\n// (I am omitting them to save space, but DO NOT DELETE THEM from your file)\n_c = DashboardStyles;\nconst loadLeaflet = cb => {\n  if (window.L) return cb();\n  const s = document.createElement('script');\n  s.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\n  s.onload = cb;\n  document.head.appendChild(s);\n  const c = document.createElement('link');\n  c.rel = 'stylesheet';\n  c.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\n  document.head.appendChild(c);\n};\nconst MapView = ({\n  userPosition\n}) => {\n  _s();\n  const r = useRef(null);\n  const m = useRef(null);\n  const mk = useRef(null);\n  useEffect(() => {\n    loadLeaflet(() => {\n      if (r.current && !m.current) {\n        const L = window.L;\n        m.current = L.map(r.current).setView([userPosition.lat, userPosition.lng], 13);\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(m.current);\n        mk.current = L.marker([userPosition.lat, userPosition.lng]).addTo(m.current);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    if (m.current && window.L) {\n      mk.current.setLatLng([userPosition.lat, userPosition.lng]);\n      m.current.setView([userPosition.lat, userPosition.lng]);\n    }\n  }, [userPosition]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: r,\n    style: {\n      width: '100%',\n      height: '100%'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 25,\n    columnNumber: 603\n  }, this);\n};\n_s(MapView, \"CpriZHXPLTAl+dMtKJJTGIOM2ks=\");\n_c2 = MapView;\nconst BeforeTripPanel = ({\n  contacts,\n  startTrip\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n    children: \"Start Trip\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 26,\n    columnNumber: 59\n  }, this), \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: startTrip,\n    style: {\n      padding: '10px',\n      background: '#4f46e5',\n      color: 'white',\n      width: '100%'\n    },\n    children: \"Start SafeWalk\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 26,\n    columnNumber: 79\n  }, this), \" \", /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: '20px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Contacts\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 239\n    }, this), contacts.map(c => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: c.name\n    }, c._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 273\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 26,\n    columnNumber: 207\n  }, this), \" \"]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 26,\n  columnNumber: 54\n}, this);\n_c3 = BeforeTripPanel;\nconst TripStatusPanel = ({\n  tripDetails,\n  onEndTrip,\n  contacts,\n  socket\n}) => {\n  _s2();\n  const [time, setTime] = useState(0);\n  const [showModal, setShowModal] = useState(false);\n\n  // FIX #2: Timer Logic - Dependent only on start time string\n  useEffect(() => {\n    if (!(tripDetails !== null && tripDetails !== void 0 && tripDetails.startedAt)) return;\n    const startTime = new Date(tripDetails.startedAt).getTime();\n    const i = setInterval(() => {\n      const now = new Date().getTime();\n      setTime(Math.floor((now - startTime) / 1000));\n    }, 1000);\n    return () => clearInterval(i);\n  }, [tripDetails.startedAt]);\n  const format = s => new Date(s * 1000).toISOString().substr(11, 8);\n  const handleSend = contact => {\n    const token = localStorage.getItem('token');\n    const payload = JSON.parse(atob(token.split('.')[1])); // Get User ID\n\n    socket.emit('notifyContacts', {\n      tripId: tripDetails._id,\n      senderName: \"User\",\n      senderId: payload.user.id,\n      // FIX #1: Send ID so we can filter self\n      contactName: contact.name\n    });\n    alert(`Sent to ${contact.name}`);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"panel-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        textAlign: 'center'\n      },\n      children: \"Trip in Progress\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"timer-display\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"ELAPSED TIME\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 38\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: format(time)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 57\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowModal(true),\n        style: {\n          flex: 1,\n          padding: '10px'\n        },\n        children: \"Share\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onEndTrip,\n        style: {\n          flex: 1,\n          padding: '10px',\n          background: 'red',\n          color: 'white'\n        },\n        children: \"End Trip\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Share \", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowModal(false),\n            style: {\n              float: 'right'\n            },\n            children: \"x\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 13\n        }, this), contacts.map(c => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"share-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: c.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 18\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleSend(c),\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 18\n          }, this)]\n        }, c._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 16\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s2(TripStatusPanel, \"3Inj1LqwtuJrT0Maksuupa9xDIE=\");\n_c4 = TripStatusPanel;\nconst Dashboard = () => {\n  _s3();\n  const [isActive, setIsActive] = useState(false);\n  const [contacts, setContacts] = useState([]);\n  const [tripDetails, setTripDetails] = useState(null);\n  const [userPos, setUserPos] = useState({\n    lat: 26.76,\n    lng: 83.37\n  });\n  const socketRef = useRef();\n  const navigate = useNavigate();\n  const watchIdRef = useRef();\n  useEffect(() => {\n    socketRef.current = io('http://localhost:5000');\n    navigator.geolocation.getCurrentPosition(p => setUserPos({\n      lat: p.coords.latitude,\n      lng: p.coords.longitude\n    }));\n    const token = localStorage.getItem('token');\n    if (token) axios.get('http://localhost:5000/api/contacts', {\n      headers: {\n        'x-auth-token': token\n      }\n    }).then(res => setContacts(res.data));\n    return () => socketRef.current.disconnect();\n  }, []);\n  const startTrip = async () => {\n    const token = localStorage.getItem('token');\n    const res = await axios.post('http://localhost:5000/api/trips/start', {\n      destination: {}\n    }, {\n      headers: {\n        'x-auth-token': token\n      }\n    });\n    setTripDetails(res.data);\n    setIsActive(true);\n    socketRef.current.emit('joinTripRoom', res.data._id);\n    watchIdRef.current = navigator.geolocation.watchPosition(p => {\n      const coords = {\n        lat: p.coords.latitude,\n        lng: p.coords.longitude\n      };\n      setUserPos(coords);\n      socketRef.current.emit('updateLocation', {\n        tripId: res.data._id,\n        coordinates: coords\n      });\n    });\n  };\n\n  // FIX #4: End Trip Logic\n  const endTrip = async () => {\n    if (watchIdRef.current) navigator.geolocation.clearWatch(watchIdRef.current);\n    const token = localStorage.getItem('token');\n\n    // 1. Tell socket\n    socketRef.current.emit('endTrip', tripDetails._id);\n\n    // 2. Tell DB\n    await axios.put(`http://localhost:5000/api/trips/${tripDetails._id}/end`, {}, {\n      headers: {\n        'x-auth-token': token\n      }\n    });\n    setIsActive(false);\n    setTripDetails(null);\n    alert(\"Trip Ended.\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard-layout\",\n    children: [/*#__PURE__*/_jsxDEV(DashboardStyles, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"map-column\",\n      children: /*#__PURE__*/_jsxDEV(MapView, {\n        userPosition: userPos\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 35\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls-column\",\n      children: isActive ? /*#__PURE__*/_jsxDEV(TripStatusPanel, {\n        tripDetails: tripDetails,\n        onEndTrip: endTrip,\n        contacts: contacts,\n        socket: socketRef.current\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(BeforeTripPanel, {\n        contacts: contacts,\n        startTrip: startTrip\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 20\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n};\n_s3(Dashboard, \"hsLcQczUwvdVJA4WE9nNP5KqATo=\", false, function () {\n  return [useNavigate];\n});\n_c5 = Dashboard;\nexport default Dashboard;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"DashboardStyles\");\n$RefreshReg$(_c2, \"MapView\");\n$RefreshReg$(_c3, \"BeforeTripPanel\");\n$RefreshReg$(_c4, \"TripStatusPanel\");\n$RefreshReg$(_c5, \"Dashboard\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Link","useNavigate","axios","io","jsxDEV","_jsxDEV","DashboardStyles","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","loadLeaflet","cb","window","L","s","document","createElement","src","onload","head","appendChild","c","rel","href","MapView","userPosition","_s","r","m","mk","current","map","setView","lat","lng","tileLayer","addTo","marker","setLatLng","ref","style","width","height","_c2","BeforeTripPanel","contacts","startTrip","onClick","padding","background","color","marginTop","name","_id","_c3","TripStatusPanel","tripDetails","onEndTrip","socket","_s2","time","setTime","showModal","setShowModal","startedAt","startTime","Date","getTime","i","setInterval","now","Math","floor","clearInterval","format","toISOString","substr","handleSend","contact","token","localStorage","getItem","payload","JSON","parse","atob","split","emit","tripId","senderName","senderId","user","id","contactName","alert","className","textAlign","display","gap","flex","float","_c4","Dashboard","_s3","isActive","setIsActive","setContacts","setTripDetails","userPos","setUserPos","socketRef","navigate","watchIdRef","navigator","geolocation","getCurrentPosition","p","coords","latitude","longitude","get","headers","then","res","data","disconnect","post","destination","watchPosition","coordinates","endTrip","clearWatch","put","_c5","$RefreshReg$"],"sources":["C:/Users/LENOVO/Desktop/shesecure/client/src/Pages/Dashboard.js"],"sourcesContent":["// ... (Imports & Styles remain the same, just copy them from previous response if needed) ...\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { io } from 'socket.io-client';\r\n\r\n// ... (KEEP YOUR EXISTING STYLES AND LOADERS HERE) ...\r\nconst DashboardStyles = () => (\r\n  <style>{`\r\n    .dashboard-layout { display: flex; height: calc(100vh - 70px); background-color: #f3f4f6; }\r\n    .map-column { flex: 3; background-color: #e5e7eb; position: relative; }\r\n    .controls-column { flex: 2; background-color: #ffffff; padding: 1.5rem; overflow-y: auto; }\r\n    .panel-container { height: 100%; display: flex; flex-direction: column; }\r\n    /* ... (rest of styles) ... */\r\n    .timer-display { text-align: center; margin: 2rem 0; }\r\n    .timer-display span { font-size: 3.5rem; font-weight: bold; color: #111; }\r\n    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; display: flex; justify-content: center; align-items: center; }\r\n    .modal-content { background: white; padding: 20px; width: 350px; border-radius: 8px; }\r\n    .share-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }\r\n  `}</style>\r\n);\r\n// ... (KEEP MAPVIEW AND BEFORETRIPPANEL HERE) ...\r\n// (I am omitting them to save space, but DO NOT DELETE THEM from your file)\r\nconst loadLeaflet = (cb) => { if (window.L) return cb(); const s=document.createElement('script'); s.src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js'; s.onload=cb; document.head.appendChild(s); const c=document.createElement('link'); c.rel='stylesheet'; c.href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'; document.head.appendChild(c); };\r\nconst MapView = ({ userPosition }) => { const r=useRef(null); const m=useRef(null); const mk=useRef(null); useEffect(()=>{loadLeaflet(()=>{if(r.current&&!m.current){const L=window.L;m.current=L.map(r.current).setView([userPosition.lat,userPosition.lng],13);L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(m.current);mk.current=L.marker([userPosition.lat,userPosition.lng]).addTo(m.current)}})},[]); useEffect(()=>{if(m.current&&window.L){mk.current.setLatLng([userPosition.lat,userPosition.lng]); m.current.setView([userPosition.lat,userPosition.lng])}},[userPosition]); return <div ref={r} style={{width:'100%', height:'100%'}}/>;};\r\nconst BeforeTripPanel = ({contacts, startTrip}) => ( <div><h3>Start Trip</h3> <button onClick={startTrip} style={{padding:'10px', background:'#4f46e5', color:'white', width:'100%'}}>Start SafeWalk</button> <div style={{marginTop:'20px'}}><h4>Contacts</h4>{contacts.map(c=><div key={c._id}>{c.name}</div>)}</div> </div> );\r\n\r\nconst TripStatusPanel = ({ tripDetails, onEndTrip, contacts, socket }) => {\r\n  const [time, setTime] = useState(0);\r\n  const [showModal, setShowModal] = useState(false);\r\n\r\n  // FIX #2: Timer Logic - Dependent only on start time string\r\n  useEffect(() => {\r\n    if(!tripDetails?.startedAt) return;\r\n    const startTime = new Date(tripDetails.startedAt).getTime();\r\n    const i = setInterval(() => {\r\n        const now = new Date().getTime();\r\n        setTime(Math.floor((now - startTime) / 1000));\r\n    }, 1000);\r\n    return () => clearInterval(i);\r\n  }, [tripDetails.startedAt]);\r\n\r\n  const format = (s) => new Date(s * 1000).toISOString().substr(11, 8);\r\n\r\n  const handleSend = (contact) => {\r\n    const token = localStorage.getItem('token');\r\n    const payload = JSON.parse(atob(token.split('.')[1])); // Get User ID\r\n    \r\n    socket.emit('notifyContacts', {\r\n        tripId: tripDetails._id,\r\n        senderName: \"User\", \r\n        senderId: payload.user.id, // FIX #1: Send ID so we can filter self\r\n        contactName: contact.name\r\n    });\r\n    alert(`Sent to ${contact.name}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"panel-container\">\r\n      <h3 style={{textAlign:'center'}}>Trip in Progress</h3>\r\n      <div className=\"timer-display\"><p>ELAPSED TIME</p><span>{format(time)}</span></div>\r\n      <div style={{display:'flex', gap:'10px'}}>\r\n        <button onClick={() => setShowModal(true)} style={{flex:1, padding:'10px'}}>Share</button>\r\n        <button onClick={onEndTrip} style={{flex:1, padding:'10px', background:'red', color:'white'}}>End Trip</button>\r\n      </div>\r\n      {showModal && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-content\">\r\n            <h3>Share <button onClick={() => setShowModal(false)} style={{float:'right'}}>x</button></h3>\r\n            {contacts.map(c => (\r\n               <div key={c._id} className=\"share-row\">\r\n                 <span>{c.name}</span>\r\n                 <button onClick={() => handleSend(c)}>Send</button>\r\n               </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst Dashboard = () => {\r\n  const [isActive, setIsActive] = useState(false);\r\n  const [contacts, setContacts] = useState([]);\r\n  const [tripDetails, setTripDetails] = useState(null);\r\n  const [userPos, setUserPos] = useState({ lat: 26.76, lng: 83.37 });\r\n  const socketRef = useRef();\r\n  const navigate = useNavigate();\r\n  const watchIdRef = useRef();\r\n\r\n  useEffect(() => {\r\n    socketRef.current = io('http://localhost:5000');\r\n    navigator.geolocation.getCurrentPosition(p => setUserPos({ lat: p.coords.latitude, lng: p.coords.longitude }));\r\n    \r\n    const token = localStorage.getItem('token');\r\n    if(token) axios.get('http://localhost:5000/api/contacts', { headers: { 'x-auth-token': token } }).then(res => setContacts(res.data));\r\n\r\n    return () => socketRef.current.disconnect();\r\n  }, []);\r\n\r\n  const startTrip = async () => {\r\n    const token = localStorage.getItem('token');\r\n    const res = await axios.post('http://localhost:5000/api/trips/start', { destination: {} }, { headers: { 'x-auth-token': token } });\r\n    setTripDetails(res.data);\r\n    setIsActive(true);\r\n    socketRef.current.emit('joinTripRoom', res.data._id);\r\n    \r\n    watchIdRef.current = navigator.geolocation.watchPosition(p => {\r\n        const coords = { lat: p.coords.latitude, lng: p.coords.longitude };\r\n        setUserPos(coords);\r\n        socketRef.current.emit('updateLocation', { tripId: res.data._id, coordinates: coords });\r\n    });\r\n  };\r\n\r\n  // FIX #4: End Trip Logic\r\n  const endTrip = async () => {\r\n    if(watchIdRef.current) navigator.geolocation.clearWatch(watchIdRef.current);\r\n    const token = localStorage.getItem('token');\r\n    \r\n    // 1. Tell socket\r\n    socketRef.current.emit('endTrip', tripDetails._id);\r\n    \r\n    // 2. Tell DB\r\n    await axios.put(`http://localhost:5000/api/trips/${tripDetails._id}/end`, {}, { headers: { 'x-auth-token': token } });\r\n\r\n    setIsActive(false);\r\n    setTripDetails(null);\r\n    alert(\"Trip Ended.\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"dashboard-layout\">\r\n      <DashboardStyles />\r\n      <div className=\"map-column\"><MapView userPosition={userPos} /></div>\r\n      <div className=\"controls-column\">\r\n        {isActive ? <TripStatusPanel tripDetails={tripDetails} onEndTrip={endTrip} contacts={contacts} socket={socketRef.current} /> \r\n                 : <BeforeTripPanel contacts={contacts} startTrip={startTrip} />}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}